{% extends 'base.html' %}

{% block title %}
    Home
{% endblock %}

{% block style %}
    <style type="text/css">
        .m {
            position: inherit;
        }
    </style>
{% endblock %}

{% block content %}
  <!-- Pass books_for_sale to the modal as available_books -->
  {% with available_books=books_for_sale, endpoint='transactions_bp.sell_book' %}
    {% include 'transactions/sell_book_modal.html' %}
  {% endwith %}

  {% include 'books/add_book_modal.html' %}
  {% include 'members/add_member_modal.html' %}
  {% include 'transactions/borrow_book_modal.html' %}
  {% with books_to_return=books_to_return %}
    {% include 'transactions/return_book_modal.html' %}
  {% endwith %}

  <div class="bg-dark text-secondary px-4 py-5 text-center">
      <div class="py-5">
          <h1 class="display-5 fw-bold text-white mrbt-2">
              Welcome to Online Library Management
          </h1>
          <div class="col-lg-6 mx-auto">
              <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                  <button type="button" class="btn btn-primary m" data-bs-toggle="modal" data-bs-target="#bookModal">
                      Create Book
                  </button>
                  <button type="button" class="btn btn-primary m" data-bs-toggle="modal" data-bs-target="#memberModal">
                      Create Member
                  </button>
                  <button type="button" class="btn btn-primary m" data-bs-toggle="modal" data-bs-target="#borrowBookModal">
                      Borrow
                  </button>
                  <button type="button" class="btn btn-primary m" data-bs-toggle="modal" data-bs-target="#sellBookModal">
                      Sell
                  </button>
                  <button type="button" class="btn btn-primary m" data-bs-toggle="modal" data-bs-target="#returnBookModal">
                      Return
                  </button>
              </div>
          </div>
      </div>
  </div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const borrowModal = document.getElementById('borrowBookModal');

        // Borrow Book Modal Script
        if (borrowModal) {
            borrowModal.addEventListener('show.bs.modal', function(event) {
                const button = event.relatedTarget;
                if (button && button.hasAttribute('data-book-id')) {
                    const bookId = button.getAttribute('data-book-id');
                    document.getElementById('book_name').value = bookId;
                }
            });
        }
    });
</script>
{% endblock %}